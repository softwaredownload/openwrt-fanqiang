# 把 overtls、tun2proxy 设置成开机自动启动的系统服务

`overtls` 搭配 `tun2proxy` 使用可以接管系统所有流量，实现全局翻墙，这有助于我们通过一些国外服务的地区鉴定，从而避免出现对方拒绝服务的情况

overtls 和 tun2proxy 是两个命令行程序，虽然我们可以用命令行脚本启动它们，但是这样做多少有些麻烦，最好是把它们创建为系统服务，这样设备开机时它们可以自动启动

下面我就来说一下如何为 overtls 和 tun2proxy 创建系统服务。要注意的是，  `tun2proxy` 的版本要在 `v0.4.3` 及以上

## Windows 创建 overtls、tun2proxy 系统服务

### 管理员身份运行 cmd

- 按 `Windows` 键
- 输入 `cmd`
- 在弹出菜单中，左侧自动选中 `Command Prompt`，我们选择菜单右侧的 `Run as administrator`

### Windows 创建 overtls 系统服务

在命令行窗口执行如下命令

```sh
# 創建 overtls 服務
sc create overtls start= auto binPath= "C:\overtls\overtls.exe --config C:\overtls\config.json --daemonize"

# 啓動 overtls 服務
net start overtls

# 查詢 overtls 服務狀態
sc queryex overtls

# 停止 overtls 服務
net stop overtls

# 刪除 overtls 服務
sc delete overtls
```

### Windows 创建 tun2proxy 系统服务

在命令行窗口执行如下命令

```sh
# 創建 tun2proxy 服務
# 如果你的服务器不支持 ipv6，就把参数 `--ipv6-enabled` 去掉
sc create tun2proxy start= auto binPath= "C:\tun2proxy\tun2proxy.exe --setup --proxy socks5://127.0.0.1:1080 --bypass 7.6.5.4 --bypass 3.2.1.0 --ipv6-enabled --daemonize"

# 啓動 tun2proxy 服務
net start tun2proxy

# 查詢 tun2proxy 服務狀態
sc queryex tun2proxy

# 停止 tun2proxy 服務
net stop tun2proxy

# 刪除 tun2proxy 服務
sc delete tun2proxy
```

注：tun2proxy 启动成功后，会在托盘显示一个类似网卡的图标，我们可以凭此确定它是否正在运行

### 相关内容

- [简单、高速、稳定的翻墙软件 overtls 安装、使用教程](05.4.md)
- [overtls + tun2proxy 实现全局翻墙，所有流量走代理](05.42.md)
- [overtls Android 手机翻墙上网教程](05.43.md)
- <https://github.com/ShadowsocksR-Live/overtls>
- <https://github.com/ShadowsocksR-Live/ssrWin>
- <https://github.com/softwaredownload/openwrt-fanqiang>

2024-09-14